{% extends "base.html" %}

<head>
    {% block styles %}
    <style>
        table {
            width: 50%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid black;
            padding: 10px;
        }
    </style>
    {% endblock %}
</head>

{% block content %}
    <h1>{{ thread.title }}</h1>
    <p><strong>Author:</strong> {{ thread.author.user.username }}</p>
    <p><strong>Category:</strong> {{ thread.category.name }}</p>
    <p><strong>Created on:</strong> {{ thread.created_on|date:"F j, Y, g:i a" }}</p>
    <p><strong>Last updated:</strong> {{ thread.updated_on|date:"F j, Y, g:i a" }}</p>

    <div>
        <br>
        <p>{{ thread.entry|linebreaks }}</p>
        <br>
        {% if thread.image %}
        <img src="{{ thread.image.url }}" alt="{{ thread.title }}" style="max-width: 200px; height: auto;">
        {% endif %}
        <br>
    </div>

    

    <h3>Comments</h3>

    <div>
        <h5>Add a Comment:</h5>
            {% if request.user.is_authenticated %}
                <h3>Add a Comment</h3>
                <form method="post">
                    {% csrf_token %}
                    <textarea name="entry" rows="4" cols="50" placeholder="Write your comment here..." required></textarea><br>
                    <button type="submit">Submit</button>
                </form>
            {% else %}
                <p><a href="{% url 'login' %}">Log in</a> to leave a comment.</p>
            {% endif %}
        <br>
        </div>

    <div>
    {% if comments %}
    <ul>
        {% for comment in comments %}
        <li>
            <strong>{{ comment.author.display_name|default:comment.author.user.username }}</strong>
            <i>{{ comment.created_on|date:"F j, Y, g:i a" }}</i><br>
            {{ comment.entry|linebreaks }}
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No comments yet.</p>
    {% endif %}
    </div>


    <div>
    {% if other_threads %}
    <h3>Related Threads:</h3>
    <ul>
        {% for thread in other_threads %}
        <li><a href="{{ thread.get_absolute_url }}">{{ thread.title }}</a></li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No related threads found.</p>
    {% endif %}
    <br>
    </div>

    {% if request.user.is_authenticated and thread.author.user == request.user %}
    <a href="{% url 'forum:edit_thread' thread.id %}">Edit Thread</a>
    {% endif %}


    <p><a href="{% url 'forum:index' %}">Back to Threads</a></p>

{% endblock %}